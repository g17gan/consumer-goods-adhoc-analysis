WITH X AS (
  SELECT 
    ROUND(MAX(manufacturing_cost), 2) AS max_cost,
    ROUND(MIN(manufacturing_cost), 2) AS min_cost
  FROM fact_manufacturing_cost
)
SELECT
  p.product_code,
  p.product,
  m.manufacturing_cost
FROM dim_product p
JOIN fact_manufacturing_cost m 
	USING(product_code)
JOIN X e
  ON ROUND(m.manufacturing_cost, 2) = e.max_cost
     OR ROUND(m.manufacturing_cost, 2) = e.min_cost
GROUP BY p.product_code, p.product, m.manufacturing_cost;

OR

SELECT
    p.product_code,
    p.product,
    m.manufacturing_cost
FROM dim_product p
JOIN fact_manufacturing_cost m
    USING(product_code)
WHERE ROUND(m.manufacturing_cost, 2) IN (
    SELECT ROUND(MAX(manufacturing_cost), 2) FROM fact_manufacturing_cost
    UNION
    SELECT ROUND(MIN(manufacturing_cost), 2) FROM fact_manufacturing_cost
)
GROUP BY p.product_code, p.product, m.manufacturing_cost;


SELECT
    p.product_code,
    p.product,
    m.manufacturing_cost
FROM dim_product p
JOIN fact_manufacturing_cost m
    USING(product_code)
WHERE ROUND(m.manufacturing_cost, 2) = (
    SELECT ROUND(MAX(manufacturing_cost), 2)
    FROM fact_manufacturing_cost
)
OR ROUND(m.manufacturing_cost, 2) = (
    SELECT ROUND(MIN(manufacturing_cost), 2)
    FROM fact_manufacturing_cost
)
GROUP BY p.product_code, p.product, m.manufacturing_cost;
