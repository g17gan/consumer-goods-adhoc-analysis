WITH x AS (
SELECT 
	channel,
    ROUND(SUM(gross_price * sold_quantity)/1000000,2) AS gross_sales_mln
FROM dim_customer c 
JOIN fact_sales_monthly s
	USING(customer_code)
JOIN fact_gross_price g
	USING(product_code, fiscal_year)
WHERE fiscal_year = 2021
GROUP BY channel
)
SELECT 
	channel,
    gross_sales_mln,
    ROUND(gross_sales_mln * 100 / SUM(gross_sales_mln) OVER (), 2) AS percentage
FROM x
ORDER BY gross_sales_mln DESC;
